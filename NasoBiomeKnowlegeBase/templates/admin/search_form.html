{% load i18n static %}
{% if cl.search_fields %}
<div id="toolbar">
  <form id="changelist-search" method="get" role="search">

    <div class="relative flex items-center gap-2">

      <div class="relative">

        <span class="absolute inset-y-0 left-3 flex items-center pointer-events-none">
          <img
            src="{% static 'admin/img/search.svg' %}"
            alt="{% translate 'Search' %}"
            class="h-4 w-4 opacity-60"
          >
        </span>

        <span class="absolute inset-y-0 right-3 hidden sm:flex items-center pointer-events-none">
          <kbd class="rounded border border-gray-300 dark:border-gray-700 bg-gray-100 dark:bg-gray-800 px-1.5 text-[10px] text-gray-600 dark:text-gray-400">
            ⌘ K
          </kbd>
        </span>

        <input
          id="searchbar"
          type="text"
          name="{{ search_var }}"
          value="{{ cl.query }}"
          placeholder="{% translate 'Search…' %}"
          class="block w-64 rounded-md border border-gray-300 dark:border-gray-700
                 bg-white dark:bg-gray-900
                 py-1.5 pr-14 text-sm leading-none
                 text-gray-900 dark:text-gray-100
                 placeholder-gray-400 dark:placeholder-gray-500
                 focus:border-primary-500 focus:ring-primary-500"
          style="padding-left: 2.25rem; text-indent: 0.25rem;"
        >
      </div>

      <input
        type="submit"
        value="{% translate 'Search' %}"
        class="rounded-md bg-primary-600 px-3 py-1.5 text-sm font-semibold text-white hover:bg-primary-500"
      >

      {% for pair in cl.params.items %}
        {% if pair.0 != search_var %}
          <input type="hidden" name="{{ pair.0 }}" value="{{ pair.1 }}">
        {% endif %}
      {% endfor %}
    </div>
  </form>
</div>

<script>
  document.addEventListener("keydown", (e) => {
    const isMac = navigator.platform.includes("Mac");
    if ((isMac ? e.metaKey : e.ctrlKey) && e.key.toLowerCase() === "k") {
      e.preventDefault();
      document.getElementById("searchbar")?.focus();
    }
  });
</script>
{% endif %}
