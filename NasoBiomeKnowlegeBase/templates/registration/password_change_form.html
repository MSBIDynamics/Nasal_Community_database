{% extends "admin/base_layout.html" %}
{% load i18n static lucide_tags %}

{% block title %}
{% if form.errors %}
{% translate "Error:" %} 
{% endif %}
{{ block.super }}
{% endblock %}

{% block extrastyle %}
{{ block.super }}
<link rel="stylesheet" href="{% static "admin/css/forms.css" %}">
<style>
  .form-group {
    margin-bottom: 1.5rem;
  }
  .input-group {
    position: relative;
  }
  .input-group .icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: #9ca3af;
    pointer-events: none;
  }
  .help-text {
    font-size: 0.75rem;
    color: #6b7280;
    margin-top: 0.5rem;
    padding: 0.5rem;
    background-color: #f3f4f6;
    border-radius: 0.375rem;
    border-left: 3px solid #6366f1;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  .help-text span {
    margin-top: 0.1rem;
  }
  .error-message {
    color: #dc2626;
    font-size: 0.75rem;
    margin-top: 0.5rem;
  }
  .btn-primary {
    background-color: #3b82f6;
    color: white;
    border: 1px solid #3b82f6;
    padding: 0.75rem 1.5rem;
    font-weight: 600;
    border-radius: 0.375rem;
    transition: all 0.2s ease;
  }
  .btn-primary:hover {
    background-color: #2563eb;
    border-color: #2563eb;
  }
  .footer-note {
    font-size: 0.75rem;
    color: #6b7280;
    text-align: center;
    padding: 0.75rem;
    border-top: 1px solid #e5e7eb;
    background-color: #f9fafb;
    margin-top: 1.5rem;
  }
</style>
{% endblock %}

{% block userlinks %}
{% url 'django-admindocs-docroot' as docsroot %}
{% if docsroot %}
<a href="{{ docsroot }}">
{% translate 'Documentation' %}</a> /
{% endif %}
{% translate 'Change password' %} /
<form id="logout-form" method="post" action="{% url 'admin:logout' %}">
    {% csrf_token %}
    <button type="submit">{% translate 'Log out' %}</button>
</form>
{% include "admin/color_theme_toggle.html" %}
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% translate 'Home' %}</a>
    &rsaquo; {% translate 'Password change' %}
</div>
{% endblock %}

{% block main_content %}
<div id="content-main"
    class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 py-12 px-4">
    <div class="max-w-md mx-auto">
        <!-- Header Section -->
        <div class="text-center mb-8">
            <div
                class="mx-auto w-16 h-16 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mb-4 shadow-lg">
                <span class="w-8 h-8 dark:text-white">
                    {% lucide "shield-check" %}
                </span>
            </div>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">{% translate 'Change Password' %}</h2>
            <p class="text-gray-600 dark:text-gray-300 text-sm">{% translate 'Update your password to keep your account secure' %}</p>
        </div>

        <!-- Form Card -->
        <div
            class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden">
            <div class="p-8">
                <!-- Error Messages -->
                {% if form.errors %}
                <div class="mb-6 p-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500 rounded-r-lg">
                    <div class="flex items-center">
                        <span class="w-4 h-4 text-red-500 mr-2">
                            {% lucide "alert-circle" %}
                        </span>
                        <p class="text-red-700 dark:text-red-300 font-medium">
                            {% blocktranslate count counter=form.errors.items|length %}
                            Please correct the error below.
                            {% plural %}
                            Please correct the errors below.
                            {% endblocktranslate %}
                        </p>
                    </div>
                </div>
                {% endif %}

                <!-- Security Notice -->
                <div class="mb-8 p-4 bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 rounded-r-lg">
                    <div class="flex items-start">
                        <span class="w-4 h-4 text-blue-500 mr-2 mt-0.5">
                            {% lucide "info" %}
                        </span>
                        <p class="text-blue-700 dark:text-blue-300 text-sm">
                            {% translate 'Please enter your old password, for security\'s sake, and then enter your new password twice so we can verify you typed it in correctly.' %}
                        </p>
                    </div>
                </div>

                <form method="post" class="space-y-6">
                    {% csrf_token %}

                    <!-- Old Password Field -->
                    <div class="form-group">
                        <label for="{{ form.old_password.id_for_label }}"
                            class="block text-sm font-semibold text-gray-700 dark:text-gray-300">
                            <span class="w-4 h-4 inline-block mr-2">
                                {% lucide "key" %}
                            </span>
                            {{ form.old_password.label }}
                        </label>
                        <div class="input-group">
                            <input type="password" name="{{ form.old_password.name }}"
                                id="{{ form.old_password.id_for_label }}"
                                class="w-full px-4 py-3 pl-12 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors duration-200"
                                placeholder="Enter your current password" required>
                            <div class="icon">
                                {% lucide "lock" %}
                            </div>
                        </div>
                        {% if form.old_password.errors %}
                        <div class="error-message">
                            {{ form.old_password.errors.0 }}
                        </div>
                        {% endif %}
                    </div>

                    <!-- New Password Field -->
                    <div class="form-group">
                        <label for="{{ form.new_password1.id_for_label }}"
                            class="block text-sm font-semibold text-gray-700 dark:text-gray-300">
                            <span class="w-4 h-4 inline-block mr-2">
                                {% lucide "key-round" %}
                            </span>
                            {{ form.new_password1.label }}
                        </label>
                        <div class="input-group">
                            <input type="password" name="{{ form.new_password1.name }}"
                                id="{{ form.new_password1.id_for_label }}"
                                class="w-full px-4 py-3 pl-12 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors duration-200"
                                placeholder="Enter your new password" required>
                            <div class="icon">
                                {% lucide "lock" %}
                            </div>
                        </div>
                        {% if form.new_password1.errors %}
                        <div class="error-message">
                            {{ form.new_password1.errors.0 }}
                        </div>
                        {% endif %}
                        {% if form.new_password1.help_text %}
                        <div class="help-text">
                            <span>{% lucide "circle-question-mark" %}</span>
                            {{ form.new_password1.help_text|safe }}
                        </div>
                        {% endif %}
                    </div>

                    <!-- Confirm Password Field -->
                    <div class="form-group">
                        <label for="{{ form.new_password2.id_for_label }}"
                            class="block text-sm font-semibold text-gray-700 dark:text-gray-300">
                            <span class="w-4 h-4 inline-block mr-2">
                                {% lucide "circle-check" %}
                            </span>
                            {{ form.new_password2.label }}
                        </label>
                        <div class="input-group">
                            <input type="password" name="{{ form.new_password2.name }}"
                                id="{{ form.new_password2.id_for_label }}"
                                class="w-full px-4 py-3 pl-12 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white transition-colors duration-200"
                                placeholder="Confirm your new password" required>
                            <div class="icon">
                                {% lucide "lock-keyhole" %}
                            </div>
                        </div>
                        {% if form.new_password2.errors %}
                        <div class="error-message">
                            {{ form.new_password2.errors.0 }}
                        </div>
                        {% endif %}
                        {% if form.new_password2.help_text %}
                        <div class="help-text">
                            <span>{% lucide "circle-question-mark" %}</span>
                            {{ form.new_password2.help_text|safe }}
                        </div>
                        {% endif %}
                    </div>

                    <!-- Submit Button -->
                    <div class="pt-4">
                        <button type="submit"
                            class="btn-primary inline-flex items-center justify-center gap-x-2 w-full rounded-md">
                            <span class="w-4 h-4">
                                {% lucide "shield-check" %}
                            </span>
                            <span>{% translate 'Change my password' %}</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Footer -->
            <div class="footer-note">
                <div class="flex items-center justify-center gap-1">
                    <span class="w-4 h-4">
                        {% lucide "shield" %}
                    </span>
                    <span>{% translate 'Your password will be encrypted and stored securely' %}</span>
                </div>
            </div>
        </div>

        <!-- Additional Security Tips -->
        <div
            class="mt-8 bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-200 dark:border-gray-700 p-6">
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center">
                <span class="w-4 h-4 mr-2 text-yellow-500">
                    {% lucide "lightbulb" %}
                </span>
                {% translate 'Password Security Tips' %}
            </h3>
            <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-300">
                <li class="flex items-start">
                    <span class="w-4 h-4 mr-2 text-green-500 mt-0.5">
                        {% lucide "check" %}
                    </span>
                    <span>{% translate 'Use at least 8 characters with a mix of letters, numbers, and symbols' %}</span>
                </li>
                <li class="flex items-start">
                    <span class="w-4 h-4 mr-2 text-green-500 mt-0.5">
                        {% lucide "check" %}
                    </span>
                    <span>{% translate 'Avoid using personal information like your name or birthday' %}</span>
                </li>
                <li class="flex items-start">
                    <span class="w-4 h-4 mr-2 text-green-500 mt-0.5">
                        {% lucide "check" %}
                    </span>
                    <span>{% translate 'Consider using a unique password for this account' %}</span>
                </li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}