{% extends 'base.html' %}
{% block title %}Migration Patterns{% endblock %}
{% block page_title %}Migration Patterns Management{% endblock %}
{% load extras %}

{% block content %}
<div class="w-full overflow-x-auto pb-6">
  <div class="ww-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

    <div class="flex flex-col sm:flex-row sm:flex-wrap justify-between items-start sm:items-center gap-4 mb-6">
        <div class="flex-1 min-w-0">
            <h1 class="text-2xl font-bold text-gray-900 dark:text-white">Migration Patterns</h1>
            <p class="text-gray-600 dark:text-gray-400 mt-1">Manage Migration Patterns.</p>
        </div>

        <a href="{% url 'add_migration' %}"
            class="w-full sm:w-auto flex items-center justify-center gap-2 px-4 py-2 bg-primary text-gray-900 font-bold rounded-lg hover:opacity-90 shadow-sm transition-opacity whitespace-nowrap">
            <span class="material-symbols-outlined text-sm">add</span>
            <span>Add Migration</span>
        </a>
    </div>

    <div class="w-full overflow-hidden rounded-lg border border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900">
      <div class="overflow-x-auto overflow-y-auto max-h-[calc(100vh-280px)]">
        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-800">
          <thead class="bg-gray-50 dark:bg-gray-800 sticky top-0 z-10">
            <tr>
              <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">Species</th>
              <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">From Site</th>
              <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">To Site</th>
              <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">Mechanism</th>
              <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">Trigger Conditions</th>
              <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">Resulting Disease</th>
              <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-600 dark:text-gray-300 uppercase tracking-wider">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200 dark:divide-gray-800">
            {% for m in migrations %}
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-850 transition-colors">
              <td class="px-4 py-3 text-sm font-medium text-gray-900 dark:text-white">{{ m.species.name|truncate }}</td>
              <td class="px-4 py-3 text-sm text-gray-600 dark:text-gray-300">{{ m.from_site.name|truncatewords:10|default:"-" }}</td>
              <td class="px-4 py-3 text-sm text-gray-600 dark:text-gray-300">
                {{ m.to_site.name|truncatewords:15|default:"—" }}
              </td>
              <td class="px-4 py-3 text-sm text-gray-600 dark:text-gray-300">
                {{ m.mechanism|truncatewords:15|default:"—" }}
              </td>
              <td class="px-4 py-3 text-sm text-gray-600 dark:text-gray-300">
                {{ m.trigger_conditions|truncatewords:15|default:"—" }}
              </td>
              <td class="px-4 py-3 text-sm text-gray-600 dark:text-gray-300">
                {{ m.resulting_disease.name|truncatewords:15|default:"—" }}
              </td>
              <td class="px-4 py-3 text-right text-sm font-medium">
                <a href="{% url 'get_migration_by_id' m.id %}"
                   class="text-primary hover:underline flex items-center justify-end gap-1">
                  View
                  <span class="material-symbols-outlined text-[16px]">arrow_forward</span>
                </a>
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="7" class="px-4 py-8 text-center text-sm text-gray-500 dark:text-gray-400">
                <div class="flex flex-col items-center justify-center gap-2">
                  <span class="material-symbols-outlined text-gray-400">Moving</span>
                  No migrations found.
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    {% comment %}
    {% if migrations.paginator.num_pages > 1 %}
    <div class="mt-6 flex justify-center">
      <nav class="flex items-center gap-1" aria-label="Pagination">
        <!-- Add your pagination logic here -->
      </nav>
    </div>
    {% endif %}
    {% endcomment %}

  </div>
</div>
{% endblock %}
